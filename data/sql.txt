select ROW_NUMBER() OVER(order by voltage desc,rem asc,nazv asc,year desc) AS rid,                            id,nazv,res,counter,s_nom,                            all_month,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else all_delta end as all_delta,                            month_b_1,                            month_1,                            case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              or rem=''                             then potr_1                              else (potr_1/1000)::dec(14,8) end as potr_1,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього'  then null                             else delta_1 end as delta_1,                            month_b_2,                            month_2,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_2                              else (potr_2/1000)::dec(14,8) end as potr_2,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_2 end as delta_2,                            month_b_3,                            month_3,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_3                              else (potr_3/1000)::dec(14,8) end as potr_3,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_3 end as delta_3,                            month_b_4,                            month_4,                            case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_4                              else (potr_4/1000)::dec(14,8) end as potr_4,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_4 end as delta_4,                            month_b_5,                            month_5,                             case when trim(rem)='05'                            or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_5                              else (potr_5/1000)::dec(14,8) end as potr_5,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_5 end as delta_5,                            month_b_6,                            month_6,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_6                              else (potr_6/1000)::dec(14,8) end as potr_6,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_6 end as delta_6,                            month_b_7,                            month_7,                            case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_7                              else (potr_7/1000)::dec(14,8) end as potr_7,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_7 end as delta_7,                            month_b_8,                            month_8,                            case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_8                              else (potr_8/1000)::dec(14,8) end as potr_8,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_8 end as delta_8,                            month_b_9,                            month_9,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_9                              else (potr_9/1000)::dec(14,8) end as potr_9,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_9 end as delta_9,                            month_b_10,                            month_10,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_10                              else (potr_10/1000)::dec(14,8) end as potr_10,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_10 end as delta_10,                            month_b_11,                            month_11,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_11                             else (potr_11/1000)::dec(14,8) end as potr_11,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_11 end as delta_11,                            month_b_12,                            month_12,                             case when trim(rem)='05'                             or (trim(rem)='01' and trim(nazv)='ЦРП-5')                             or (trim(rem)='02' and trim(nazv)='РП-1')                             or (trim(rem)='02' and trim(nazv)='РП-2')                             or (trim(rem)='02' and trim(nazv)='РП-3')                             or (trim(rem)='-' and nazv like '%САЗ%')                             or (trim(rem)='-' and nazv like '%ДШЗ-1%')                              then potr_12                              else (potr_12/1000)::dec(14,8) end as potr_12,                            case when counter<>chr(8287)||'Усього:' and substr(nazv,1,6)<>'Усього' then null else delta_12 end as delta_12,                            voltage,year,koef from (    select 0 as priority,a.*,        (a.month_1-a.month_b_1)*a.koef as potr_1,    (a.month_2-a.month_b_2)*a.koef as potr_2,    (a.month_3-a.month_b_3)*a.koef as potr_3,    (a.month_4-a.month_b_4)*a.koef as potr_4,    (a.month_5-a.month_b_5)*a.koef as potr_5,    (a.month_6-a.month_b_6)*a.koef as potr_6,    (a.month_7-a.month_b_7)*a.koef as potr_7,    (a.month_8-a.month_b_8)*a.koef as potr_8,    (a.month_9-a.month_b_9)*a.koef as potr_9,    (a.month_10-a.month_b_10)*a.koef as potr_10,    (a.month_11-a.month_b_11)*a.koef as potr_11,    (a.month_12-a.month_b_12)*a.koef as potr_12,        ((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,       (sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) over(PARTITION by a.nazv,a.rem)-b.mon_1)                             ::dec(14,6) as delta_1,                                 sum((a. month_2-a.month_b_2)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_2 as delta_2,    sum((a. month_3-a.month_b_3)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_3 as delta_3,    sum((a. month_4-a.month_b_4)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_4 as delta_4,    sum((a. month_5-a.month_b_5)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_5 as delta_5,    sum((a. month_6-a.month_b_6)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_6 as delta_6,    sum((a. month_7-a.month_b_7)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_7 as delta_7,    sum((a. month_8-a.month_b_8)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_8 as delta_8,    sum((a. month_9-a.month_b_9)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_9 as delta_9,    sum((a. month_10-a.month_b_10)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_10 as delta_10,    sum((a. month_11-a.month_b_11)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_11 as delta_11,    sum((a. month_12-a.month_b_12)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_12 as delta_12,        (sum((a. month_1-a.month_b_1)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_1)+    (sum((a. month_2-a.month_b_2)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_2)+    (sum((a. month_3-a.month_b_3)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_3)+    (sum((a. month_4-a.month_b_4)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_4)+    (sum((a. month_5-a.month_b_5)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_5)+    (sum((a. month_6-a.month_b_6)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_6)+    (sum((a. month_7-a.month_b_7)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_7)+    (sum((a. month_8-a.month_b_8)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_8)+    (sum((a. month_9-a.month_b_9)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_9)+    (sum((a. month_10-a.month_b_10)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_10)+    (sum((a. month_11-a.month_b_11)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_11)+    (sum((a. month_12-a.month_b_12)*a.koef) over(PARTITION by a.nazv,a.rem)-b.mon_12) as all_delta,                                c.rem as res                            from needs_fact a                            join needs_norm b on trim(a.nazv)=trim(b.nazv)                             and a.rem=b.rem                            and a.year=b.year                            and case when 2022=0 then a.year>=2022 else a.year=2022 end                             left join kod_rem c on a.rem=c.kod_rem                                                         union all                                  select 0 as priority,min(a.id)+1 as id,a.nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    a.year,a.rem,a.voltage,     chr(8287)||'Усього:' as counter,'' as s_nom,     sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,    0 as koef,    sum((a.month_1-a.month_b_1)*a.koef) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,         sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,        	    (sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef))-b.mon_1)::dec(14,6) as delta_1,                                 sum((a.month_2-a.month_b_2)*a.koef)-b.mon_2 as delta_2,    sum((a.month_3-a.month_b_3)*a.koef)-b.mon_3 as delta_3,    sum((a.month_4-a.month_b_4)*a.koef)-b.mon_4 as delta_4,    sum((a.month_5-a.month_b_5)*a.koef)-b.mon_5 as delta_5,    sum((a.month_6-a.month_b_6)*a.koef)-b.mon_6 as delta_6,    sum((a.month_7-a.month_b_7)*a.koef)-b.mon_7 as delta_7,    sum((a.month_8-a.month_b_8)*a.koef)-b.mon_8 as delta_8,    sum((a.month_9-a.month_b_9)*a.koef)-b.mon_9 as delta_9,    sum((a.month_10-a.month_b_10)*a.koef)-b.mon_10 as delta_10,    sum((a.month_11-a.month_b_11)*a.koef)-b.mon_11 as delta_11,    sum((a.month_12-a.month_b_12)*a.koef)-b.mon_12 as delta_12,        sum((a.month_1-a.month_b_1)*a.koef)-b.mon_1+        sum((a.month_2-a.month_b_2)*a.koef)-b.mon_2+        sum((a.month_3-a.month_b_3)*a.koef)-b.mon_3+        sum((a.month_4-a.month_b_4)*a.koef)-b.mon_4+        sum((a.month_5-a.month_b_5)*a.koef)-b.mon_5+        sum((a.month_6-a.month_b_6)*a.koef)-b.mon_6+        sum((a.month_7-a.month_b_7)*a.koef)-b.mon_7+        sum((a.month_8-a.month_b_8)*a.koef)-b.mon_8+        sum((a.month_9-a.month_b_9)*a.koef)-b.mon_9+        sum((a.month_10-a.month_b_10)*a.koef)-b.mon_10+        sum((a.month_11-a.month_b_11)*a.koef)-b.mon_11+        sum((a.month_12-a.month_b_12)*a.koef)-b.mon_12 as all_delta,    c.rem as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem         and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      left join kod_rem c on a.rem=c.kod_rem     group by a.nazv,a.year,a.rem,a.voltage,c.rem,b.mon_1,     b.mon_2,b.mon_3,b.mon_4,b.mon_5,b.mon_6,b.mon_7,b.mon_8,     b.mon_9,b.mon_10,b.mon_11,b.mon_12                                union all                                select 1 as priority,10480 as id,'Усього 6 кВ:' as nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    0 as year,    '' as rem,    6 as voltage,    '' as counter,'' as s_nom,    sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,     0 as koef,    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) as potr_1,    -- sum((a.month_1-a.month_b_1)*a.koef) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,        sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,	    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)-b.mon_1) as delta_1, --  sum((a.month_1-a.month_b_1)*a.koef-b.mon_1) as delta_1,    sum((a.month_2-a.month_b_2)*a.koef-b.mon_2) as delta_2,    sum((a.month_3-a.month_b_3)*a.koef-b.mon_3) as delta_3,    sum((a.month_4-a.month_b_4)*a.koef-b.mon_4) as delta_4,    sum((a.month_5-a.month_b_5)*a.koef-b.mon_5) as delta_5,    sum((a.month_6-a.month_b_6)*a.koef-b.mon_6) as delta_6,    sum((a.month_7-a.month_b_7)*a.koef-b.mon_7) as delta_7,    sum((a.month_8-a.month_b_8)*a.koef-b.mon_8) as delta_8,    sum((a.month_9-a.month_b_9)*a.koef-b.mon_9) as delta_9,    sum((a.month_10-a.month_b_10)*a.koef-b.mon_10) as delta_10,    sum((a.month_11-a.month_b_11)*a.koef-b.mon_11) as delta_11,    sum((a.month_12-a.month_b_12)*a.koef-b.mon_12) as delta_12,    sum(((a. month_1-a.month_b_1)*a.koef-b.mon_1)+        ((a. month_2-a.month_b_2)*a.koef-b.mon_2)+        ((a. month_3-a.month_b_3)*a.koef-b.mon_3)+        ((a. month_4-a.month_b_4)*a.koef-b.mon_4)+        ((a. month_5-a.month_b_5)*a.koef-b.mon_5)+        ((a. month_6-a.month_b_6)*a.koef-b.mon_6)+        ((a. month_7-a.month_b_7)*a.koef-b.mon_7)+        ((a. month_8-a.month_b_8)*a.koef-b.mon_8)+        ((a. month_9-a.month_b_9)*a.koef-b.mon_9)+        ((a. month_10-a.month_b_10)*a.koef-b.mon_10)+        ((a. month_11-a.month_b_11)*a.koef-b.mon_11)+        ((a. month_12-a.month_b_12)*a.koef-b.mon_12)) as all_delta,    '' as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem     and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      where a.voltage=6          union all                               select 2 as priority,10490 as id,'Усього 10 кВ:' as nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    0 as year,    '' as rem,    10 as voltage,    '' as counter,'' as s_nom,    sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,     0 as koef,    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,        sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,	     sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)-b.mon_1) as delta_1,    sum((a.month_2-a.month_b_2)*a.koef-b.mon_2) as delta_2,    sum((a.month_3-a.month_b_3)*a.koef-b.mon_3) as delta_3,    sum((a.month_4-a.month_b_4)*a.koef-b.mon_4) as delta_4,    sum((a.month_5-a.month_b_5)*a.koef-b.mon_5) as delta_5,    sum((a.month_6-a.month_b_6)*a.koef-b.mon_6) as delta_6,    sum((a.month_7-a.month_b_7)*a.koef-b.mon_7) as delta_7,    sum((a.month_8-a.month_b_8)*a.koef-b.mon_8) as delta_8,    sum((a.month_9-a.month_b_9)*a.koef-b.mon_9) as delta_9,    sum((a.month_10-a.month_b_10)*a.koef-b.mon_10) as delta_10,    sum((a.month_11-a.month_b_11)*a.koef-b.mon_11) as delta_11,    sum((a.month_12-a.month_b_12)*a.koef-b.mon_12) as delta_12,    sum(((a. month_1-a.month_b_1)*a.koef-b.mon_1)+        ((a. month_2-a.month_b_2)*a.koef-b.mon_2)+        ((a. month_3-a.month_b_3)*a.koef-b.mon_3)+        ((a. month_4-a.month_b_4)*a.koef-b.mon_4)+        ((a. month_5-a.month_b_5)*a.koef-b.mon_5)+        ((a. month_6-a.month_b_6)*a.koef-b.mon_6)+        ((a. month_7-a.month_b_7)*a.koef-b.mon_7)+        ((a. month_8-a.month_b_8)*a.koef-b.mon_8)+        ((a. month_9-a.month_b_9)*a.koef-b.mon_9)+        ((a. month_10-a.month_b_10)*a.koef-b.mon_10)+        ((a. month_11-a.month_b_11)*a.koef-b.mon_11)+        ((a. month_12-a.month_b_12)*a.koef-b.mon_12)) as all_delta,    '' as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem     and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      where a.voltage=10          union all     select 3 as priority,10491 as id,'Усього 35 кВ:' as nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    0 as year,    '' as rem,    35 as voltage,    '' as counter,'' as s_nom,   sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,     0 as koef,    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,        sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,	     sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)-b.mon_1) as delta_1,    sum((a.month_2-a.month_b_2)*a.koef-b.mon_2) as delta_2,    sum((a.month_3-a.month_b_3)*a.koef-b.mon_3) as delta_3,    sum((a.month_4-a.month_b_4)*a.koef-b.mon_4) as delta_4,    sum((a.month_5-a.month_b_5)*a.koef-b.mon_5) as delta_5,    sum((a.month_6-a.month_b_6)*a.koef-b.mon_6) as delta_6,    sum((a.month_7-a.month_b_7)*a.koef-b.mon_7) as delta_7,    sum((a.month_8-a.month_b_8)*a.koef-b.mon_8) as delta_8,    sum((a.month_9-a.month_b_9)*a.koef-b.mon_9) as delta_9,    sum((a.month_10-a.month_b_10)*a.koef-b.mon_10) as delta_10,    sum((a.month_11-a.month_b_11)*a.koef-b.mon_11) as delta_11,    sum((a.month_12-a.month_b_12)*a.koef-b.mon_12) as delta_12,    sum(((a. month_1-a.month_b_1)*a.koef-b.mon_1)+        ((a. month_2-a.month_b_2)*a.koef-b.mon_2)+        ((a. month_3-a.month_b_3)*a.koef-b.mon_3)+        ((a. month_4-a.month_b_4)*a.koef-b.mon_4)+        ((a. month_5-a.month_b_5)*a.koef-b.mon_5)+        ((a. month_6-a.month_b_6)*a.koef-b.mon_6)+        ((a. month_7-a.month_b_7)*a.koef-b.mon_7)+        ((a. month_8-a.month_b_8)*a.koef-b.mon_8)+        ((a. month_9-a.month_b_9)*a.koef-b.mon_9)+        ((a. month_10-a.month_b_10)*a.koef-b.mon_10)+        ((a. month_11-a.month_b_11)*a.koef-b.mon_11)+        ((a. month_12-a.month_b_12)*a.koef-b.mon_12)) as all_delta,    '' as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem      and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      where a.voltage=35          union all             select 4 as priority,10495 as id,'Усього 150 кВ:' as nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    0 as year,    '' as rem,    150 as voltage,    '' as counter,'' as s_nom,    sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,    0 as koef,    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,        sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,	     sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)-b.mon_1) as delta_1,    sum((a.month_2-a.month_b_2)*a.koef-b.mon_2) as delta_2,    sum((a.month_3-a.month_b_3)*a.koef-b.mon_3) as delta_3,    sum((a.month_4-a.month_b_4)*a.koef-b.mon_4) as delta_4,    sum((a.month_5-a.month_b_5)*a.koef-b.mon_5) as delta_5,    sum((a.month_6-a.month_b_6)*a.koef-b.mon_6) as delta_6,    sum((a.month_7-a.month_b_7)*a.koef-b.mon_7) as delta_7,    sum((a.month_8-a.month_b_8)*a.koef-b.mon_8) as delta_8,    sum((a.month_9-a.month_b_9)*a.koef-b.mon_9) as delta_9,    sum((a.month_10-a.month_b_10)*a.koef-b.mon_10) as delta_10,    sum((a.month_11-a.month_b_11)*a.koef-b.mon_11) as delta_11,    sum((a.month_12-a.month_b_12)*a.koef-b.mon_12) as delta_12,    sum(((a. month_1-a.month_b_1)*a.koef-b.mon_1)+        ((a. month_2-a.month_b_2)*a.koef-b.mon_2)+        ((a. month_3-a.month_b_3)*a.koef-b.mon_3)+        ((a. month_4-a.month_b_4)*a.koef-b.mon_4)+        ((a. month_5-a.month_b_5)*a.koef-b.mon_5)+        ((a. month_6-a.month_b_6)*a.koef-b.mon_6)+        ((a. month_7-a.month_b_7)*a.koef-b.mon_7)+        ((a. month_8-a.month_b_8)*a.koef-b.mon_8)+        ((a. month_9-a.month_b_9)*a.koef-b.mon_9)+        ((a. month_10-a.month_b_10)*a.koef-b.mon_10)+        ((a. month_11-a.month_b_11)*a.koef-b.mon_11)+        ((a. month_12-a.month_b_12)*a.koef-b.mon_12)) as all_delta,    '' as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem     and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      where a.voltage=150          union all                                                          select 7 as priority,10500 as id,'Усього:' as nazv,    sum(a.month_1) as month_1,    sum(a.month_2) as month_2,    sum(a.month_3) as month_3,    sum(a.month_4) as month_4,    sum(a.month_5) as month_5,    sum(a.month_6) as month_6,    sum(a.month_7) as month_7,    sum(a.month_8) as month_8,    sum(a.month_9) as month_9,    sum(a.month_10) as month_10,    sum(a.month_11) as month_11,    sum(a.month_12) as month_12,    0 as year,    '' as rem,    0 as voltage,    '' as counter,'' as s_nom,    sum(a.month_b_1) as month_b_1,    sum(a.month_b_2) as month_b_2,    sum(a.month_b_3) as month_b_3,    sum(a.month_b_4) as month_b_4,    sum(a.month_b_5) as month_b_5,    sum(a.month_b_6) as month_b_6,    sum(a.month_b_7) as month_b_7,    sum(a.month_b_8) as month_b_8,    sum(a.month_b_9) as month_b_9,    sum(a.month_b_10) as month_b_10,    sum(a.month_b_11) as month_b_11,    sum(a.month_b_12) as month_b_12,     0 as koef,    sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)) as potr_1,    sum((a.month_2-a.month_b_2)*a.koef) as potr_2,    sum((a.month_3-a.month_b_3)*a.koef) as potr_3,    sum((a.month_4-a.month_b_4)*a.koef) as potr_4,    sum((a.month_5-a.month_b_5)*a.koef) as potr_5,    sum((a.month_6-a.month_b_6)*a.koef) as potr_6,    sum((a.month_7-a.month_b_7)*a.koef) as potr_7,    sum((a.month_8-a.month_b_8)*a.koef) as potr_8,    sum((a.month_9-a.month_b_9)*a.koef) as potr_9,    sum((a.month_10-a.month_b_10)*a.koef) as potr_10,    sum((a.month_11-a.month_b_11)*a.koef) as potr_11,    sum((a.month_12-a.month_b_12)*a.koef) as potr_12,        sum((a.month_1-a.month_b_1)*a.koef+(a.month_2-a.month_b_2)*a.koef+(a.month_3-a.month_b_3)*a.koef+    (a.month_4-a.month_b_4)*a.koef+    (a.month_5-a.month_b_5)*a.koef+(a.month_6-a.month_b_6)*a.koef+(a.month_7-a.month_b_7)*a.koef+    (a.month_8-a.month_b_8)*a.koef+    (a.month_9-a.month_b_9)*a.koef+(a.month_10-a.month_b_10)*a.koef+(a.month_11-a.month_b_11)*a.koef+    (a.month_12-a.month_b_12)*a.koef) as all_month,	     sum(f_macro1(a.rem,a.nazv,a.month_1,a.month_b_1,a.koef)-b.mon_1) as delta_1,    sum((a.month_2-a.month_b_2)*a.koef-b.mon_2) as delta_2,    sum((a.month_3-a.month_b_3)*a.koef-b.mon_3) as delta_3,    sum((a.month_4-a.month_b_4)*a.koef-b.mon_4) as delta_4,    sum((a.month_5-a.month_b_5)*a.koef-b.mon_5) as delta_5,    sum((a.month_6-a.month_b_6)*a.koef-b.mon_6) as delta_6,    sum((a.month_7-a.month_b_7)*a.koef-b.mon_7) as delta_7,    sum((a.month_8-a.month_b_8)*a.koef-b.mon_8) as delta_8,    sum((a.month_9-a.month_b_9)*a.koef-b.mon_9) as delta_9,    sum((a.month_10-a.month_b_10)*a.koef-b.mon_10) as delta_10,    sum((a.month_11-a.month_b_11)*a.koef-b.mon_11) as delta_11,    sum((a.month_12-a.month_b_12)*a.koef-b.mon_12) as delta_12,    sum(((a. month_1-a.month_b_1)*a.koef-b.mon_1)+        ((a. month_2-a.month_b_2)*a.koef-b.mon_2)+        ((a. month_3-a.month_b_3)*a.koef-b.mon_3)+        ((a. month_4-a.month_b_4)*a.koef-b.mon_4)+        ((a. month_5-a.month_b_5)*a.koef-b.mon_5)+        ((a. month_6-a.month_b_6)*a.koef-b.mon_6)+        ((a. month_7-a.month_b_7)*a.koef-b.mon_7)+        ((a. month_8-a.month_b_8)*a.koef-b.mon_8)+        ((a. month_9-a.month_b_9)*a.koef-b.mon_9)+        ((a. month_10-a.month_b_10)*a.koef-b.mon_10)+        ((a. month_11-a.month_b_11)*a.koef-b.mon_11)+        ((a. month_12-a.month_b_12)*a.koef-b.mon_12)) as all_delta,    '' as res    from needs_fact a    join needs_norm b on trim(a.nazv)=trim(b.nazv) and a.year=b.year     and a.rem=b.rem      and 1=1 and case when 2022=0 then a.year>=2022 else a.year=2022 end      and 1=1 and case when 2022=0 then 1=1 else a.year=2022 end     ) s order by priority asc,voltage desc,rem asc,nazv asc,year desc,ascii(counter) desc
